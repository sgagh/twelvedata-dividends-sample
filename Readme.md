# Twelvedata dividends sample extractor
Extract dividends and SEC reports data from the Twelve Data API and create a sample JSON file.
Code is generated by GitHub Copilot.

## Setup

1. Install Python 3.12+ if not already installed
2. Create and activate a Python 3.12 virtual environment:
   ```bash
   python3.12 -m venv .venv
   source .venv/bin/activate  # On Linux/Mac
   # OR
   .venv\Scripts\activate     # On Windows
   ```
3. Install required dependencies:
   ```bash
   pip install -r requirements.txt
   ```
4. Copy `.env.example` to `.env` and add your Twelve Data API key:
   ```bash
   cp .env.example .env
   ```
4. Edit `.env` and replace `your_twelve_data_api_key_here` with your actual API key

## Usage

Run the script with required arguments:

```bash
python extract_dividends.py <start_date> <end_date> [--limit <number>] [--debug]
```

### Arguments

- `start_date` (required): Start date for API requests in YYYY-MM-DD format
- `end_date` (required): End date for API requests in YYYY-MM-DD format  
- `--limit` (optional): Limit number of symbols to process (default: 0 = no limit)
- `--debug` (optional): Enable debug logging for detailed API request information

### Examples

```bash
# Process all symbols from Jan 1 to Dec 31, 2024
python extract_dividends.py 2024-01-01 2024-12-31

# Process only first 10 symbols from the list
python extract_dividends.py 2024-01-01 2024-12-31 --limit 10

# Process symbols for Q1 2024 with debug logging
python extract_dividends.py 2024-01-01 2024-03-31 --debug

# Process limited symbols with debug logging
python extract_dividends.py 2024-01-01 2024-12-31 --limit 5 --debug
```

## Output

The script generates a JSON file named `output/dividends_data_<start_date>_<end_date>.json` containing:

- Symbol information (ticker, name, exchange)
- Dividend data within the specified date range
- SEC reports with files containing dividend-related content

All output files are saved in the `output/` directory, which is excluded from git tracking.

See `prompt.md` for the detailed output format specification.

## Features

- Loads symbols from `symbols.txt`
- Retrieves stock information from Twelve Data API
- Fetches SEC reports and analyzes HTML files for dividend content
- Downloads dividends calendar data
- Uses random user agents and delays for SEC requests
- Exports results to structured JSON format
- Progress tracking and error handling
- **Comprehensive logging system with debug mode**
- **API request monitoring and performance tracking**
- **Detailed error logging with stack traces**

## Logging

The script includes comprehensive logging functionality:

- **Log Files**: Saved in `logs/` directory with timestamp
- **Console Output**: Real-time progress and status updates
- **Debug Mode**: Use `--debug` flag for detailed API request information
- **Performance Tracking**: Request duration and response analysis
- **Error Handling**: Detailed error messages and stack traces

### Log Levels
- **INFO**: General progress and status information
- **DEBUG**: Detailed API requests, responses, and internal operations
- **WARNING**: Non-critical issues (e.g., symbols with no data)
- **ERROR**: Critical errors with detailed context
